###########################
# Dorwinion Events
###########################

add_namespace = dorwinion

# Rhun asks for help in civil war
country_event = {
	id = dorwinion.1
	title = dorwinion.1.t
	desc = dorwinion.1.d
	picture = GFX_report_event_elven_alliance

	is_triggered_only = yes

	option = { #Troops
		name = dorwinion.1.a
		ai_chance = {
			base = 99
			modifier = {
				factor = -99
				OR = {
					has_government = belligerent
					has_government = revolutionary
				}
			}
		}
        add_manpower = -25000
		custom_effect_tooltip = DOR_this_will_send_troops
		hidden_effect = {
			RHU = {
				load_oob = "rhun/CV_dorwinion_reinforcement"
			}
		}
	}
	option = { #Equipment
		name = dorwinion.1.b
		ai_chance = {
			base = 0
			modifier = {
				factor = 10
				OR = {
					has_government = belligerent
					has_government = revolutionary
				}
			}
		}
		send_equipment = { target = RHU type = infantry_equipment amount = 2000 }
	}
	option = { #Nothing
		name = dorwinion.1.c
		ai_chance = {
			base = 0
			modifier = {
				factor = 10
				OR = {
					has_government = belligerent
					has_government = revolutionary
				}
			}
		}
		
	}
}


# Proposal of construction of embassy
country_event = {
	id = dorwinion.2
	title = dorwinion.2.t
	desc = dorwinion.2.d
	picture = GFX_report_event_ring

	is_triggered_only = yes

	option = { #yes
		name = dorwinion.2.a
		ai_chance = {
			base = 40
			modifier = {
				add = 20
				has_opinion = {
					target = RHU
					value > 25
				}
			}
			modifier = {
				add = 20
				belligerent > 0.20
			}
		}
		DOR = {
			add_popularity = {
				ideology = belligerent
				popularity = 0.10
			}
			add_political_power = 100
			random_owned_state = {
				add_extra_state_shared_building_slots = 1
				add_building_construction = { type = industrial_complex level = 1 instant_build = yes }
			}
			add_opinion_modifier = { target = RHU modifier = medium_increase }
		}
		RHU = {
			add_opinion_modifier = { target = DOR modifier = medium_increase }
			country_event = { id = rhun.8 }
		}
	}

	option = { #no
		name = dorwinion.2.b
		ai_chance = {
			base = 20
		}
		add_political_power = -100
		RHU = {
			add_opinion_modifier = { target = DOR modifier = medium_decrease }
			country_event = { id = rhun.1 }
		}
	}
}

country_event = {
	id = dorwinion.3
	title = dorwinion.3.t
	desc = dorwinion.3.d
	picture = GFX_report_event_paper

	is_triggered_only = yes

	option = { #yes
		name = dorwinion.3.a
		ai_chance = {
			base = 70
			modifier = {
				add = 15
				ROOT = {
					has_opinion = {
					target = DOR
					value > 50
					}
				}
			}
			modifier = {
				add = 30
				ROOT = {
					is_in_faction_with = DOR
					}
				}
				modifier = {
				add = 100
				ROOT = {
					is_puppet_of = DOR
				}
			}
		}
		ROOT = {
		add_ideas = { DOR_wine_trade_receiver } 
		}
		DOR = {
			if = {
				limit = {
					has_idea = DOR_wine_trade
				}
				swap_ideas = {
					remove_idea = DOR_wine_trade
					add_idea = DOR_wine_trade_2
				}
			}
			else_if = {
				limit = {
					has_idea = DOR_wine_trade_2
				}
				swap_ideas = {
					remove_idea = DOR_wine_trade_2
					add_idea = DOR_wine_trade_3
				}
			}
			else_if = {
				limit = {
					has_idea = DOR_wine_trade_3
				}
				swap_ideas = {
					remove_idea = DOR_wine_trade_3
					add_idea = DOR_wine_trade_4
				}
			}
			else_if = {
				limit = {
					has_idea = DOR_wine_trade_4
				}
				swap_ideas = {
					remove_idea = DOR_wine_trade_4
					add_idea = DOR_wine_trade_5
				}
			}
			else_if = {
				limit = {
					has_idea = DOR_wine_trade_5
				}
				swap_ideas = {
					remove_idea = DOR_wine_trade_5
					add_idea = DOR_wine_trade_6
				}
			}
			else_if = {
				limit = {
					has_idea = DOR_wine_trade_6
				}
				swap_ideas = {
					remove_idea = DOR_wine_trade_6
					add_idea = DOR_wine_trade_7
				}
			}
			else_if = {
				limit = {
					has_idea = DOR_wine_trade_7
				}
				swap_ideas = {
					remove_idea = DOR_wine_trade_7
					add_idea = DOR_wine_trade_8
				}
			}
			else_if = {
				limit = {
					has_idea = DOR_wine_trade_8
				}
				swap_ideas = {
					remove_idea = DOR_wine_trade_8
					add_idea = DOR_wine_trade_9
				}
			}
			else_if = {
				limit = {
					has_idea = DOR_wine_trade_9
				}
				swap_ideas = {
					remove_idea = DOR_wine_trade_9
					add_idea = DOR_wine_trade_10
				}
			}
			else_if = {
				limit = {
					has_idea = DOR_wine_trade_10
				}
				swap_ideas = {
					remove_idea = DOR_wine_trade_10
					add_idea = DOR_wine_trade_11
				}
			}
			else_if = {
				limit = {
					has_idea = DOR_wine_trade_11
				}
				swap_ideas = {
					remove_idea = DOR_wine_trade_11
					add_idea = DOR_wine_trade_12
				}
			}
			country_event = dorwinion.4
		}
	}

	option = { #Nothing
		name = dorwinion.3.b
		ai_chance = {
			base = 30
			modifier = {
				add = 30
				ROOT = {
					has_opinion = {
					target = DOR
					value < 50
					}
				}
			}
		}
		reverse_add_opinion_modifier = {
    		target = DOR
    		modifier = small_decrease
		}
		DOR = {
			country_event = dorwinion.5
		}
	}
}

country_event = {
	id = dorwinion.4
	title = dorwinion.4.t
	desc = dorwinion.4.d
	picture = GFX_report_event_paper

	is_triggered_only = yes


	option = { #PP
		name = dorwinion.4.a
		add_political_power = 25
		clr_country_flag = DOR_delegation_sent
	}
}
country_event = {
	id = dorwinion.5
	title = dorwinion.5.t
	desc = dorwinion.5.d
	picture = GFX_report_event_paper

	is_triggered_only = yes


	option = { #Nothing
		name = dorwinion.5.a
		clr_country_flag = DOR_delegation_sent
	}
}
country_event = {
	id = dorwinion.6
	title = dorwinion.6.t
	desc = dorwinion.6.d
	picture = GFX_report_event_paper

	is_triggered_only = yes


	option = {
		name = dorwinion.6.a

		ai_chance = {
			base = 80
			}
		
############################### LOGATHAVULD

		if = {
			limit = {
				DOR = {
					has_defensive_war_with = RHU
					controls_state = 127
				}
			}
			LGT = {
				set_state_owner = 127
				reverse_add_opinion_modifier = {
    				target = DOR
   					modifier = large_increase
				}
			}
			DOR = {
				puppet = {
    				target = LGT
    				end_wars = no
				}
			}
		}
		if = {
			limit = {
				DOR = {
					has_defensive_war_with = RHU
					controls_state = 207
				}
			}
			LGT = {
				set_state_owner = 207
				reverse_add_opinion_modifier = {
    				target = DOR
   					modifier = large_increase
				}
			}
			DOR = {
				puppet = {
    				target = LGT
    				end_wars = no
				}
			}
		}
		if = {
			limit = {
				DOR = {
					has_defensive_war_with = RHU
					controls_state = 209
				}
			}
			LGT = {
				set_state_owner = 209
				reverse_add_opinion_modifier = {
    				target = DOR
   					modifier = large_increase
				}
			}
			DOR = {
				puppet = {
    				target = LGT
    				end_wars = no
				}
			}
		}

############################### LOGATHAVULD

############################### DAGORLAD

		if = {
			limit = {
				DOR = {
					has_defensive_war_with = RHU
					controls_state = 205
				}
			}
			DOR = {
				set_state_owner = 205
			}
		}

		if = {
			limit = {
				DOR = {
					has_defensive_war_with = RHU
					controls_state = 100
				}
			}
			DOR = {
				set_state_owner = 100
			}
		}

		if = {
			limit = {
				DOR = {
					has_defensive_war_with = RHU
					controls_state = 206
				}
			}
			DOR = {
				set_state_owner = 206
			}
		}

		if = {
			limit = {
				DOR = {
					has_defensive_war_with = RHU
					controls_state = 98
				}
			}
			DOR = {
				set_state_owner = 98
			}
		}

		if = {
			limit = {
				DOR = {
					has_defensive_war_with = RHU
					controls_state = 101
				}
			}
			DOR = {
				set_state_owner = 101
			}
		}

		if = {
			limit = {
				DOR = {
					has_defensive_war_with = RHU
					controls_state = 204
				}
			}
			DOR = {
				set_state_owner = 204
			}
		}

		if = {
			limit = {
				DOR = {
					has_defensive_war_with = RHU
					controls_state = 203
				}
			}
			DOR = {
				set_state_owner = 203
			}
		}

############################### DAGORLAD

############################### RHOVANIA

		if = {
			limit = {
				DOR = {
					has_defensive_war_with = RHU
					controls_state = 237
				}
			}
			DOR = {
				set_state_owner = 237
			}
		}

		if = {
			limit = {
				DOR = {
					has_defensive_war_with = RHU
					controls_state = 97
				}
			}
			DOR = {
				set_state_owner = 97
			}
		}

		if = {
			limit = {
				DOR = {
					has_defensive_war_with = RHU
					controls_state = 96
				}
			}
			DOR = {
				set_state_owner = 96
			}
		}

		if = {
			limit = {
				DOR = {
					has_defensive_war_with = RHU
					controls_state = 99
				}
			}
			DOR = {
				set_state_owner = 99
			}
		}

############################### RHOVANIA

############################### RDOR PROPER

		if = {
			limit = {
				DOR = {
					has_defensive_war_with = RHU
					controls_state = 104
				}
			}
			DOR = {
				set_state_owner = 104
			}
		}
		if = {
			limit = {
				DOR = {
					has_defensive_war_with = RHU
					controls_state = 124
				}
			}
			DOR = {
				set_state_owner = 124
			}
		}
		if = {
			limit = {
				DOR = {
					has_defensive_war_with = RHU
					controls_state = 131
				}
			}
			131 = {
				add_claim_by = DOR
			}
		}

############################### RDOR PROPER

		if = {
			limit = {
				DOR = {
					has_defensive_war_with = RHU
				}
			}
			white_peace = DOR
		}
		if = {
			limit = {
				DOR = {
					has_defensive_war_with = MOR
				}
			}
			white_peace = DOR
		}
	}
	
	option = {
		name = dorwinion.6.b
		ai_chance = {
			base = 20
			}
		add_stability = -0.2
		add_war_support = -0.2
	}
}

#########################################################


country_event = {
	id = dorwinion.7
	title = dorwinion.7.t
	desc = dorwinion.7.d
	picture = GFX_report_event_paper

	is_triggered_only = yes


	option = { #Nothing
		name = dorwinion.7.a
		set_cosmetic_tag = DOR_tutelage
		add_political_power = 25
	}
	option = { #Nothing
		name = dorwinion.7.b
		set_cosmetic_tag = DOR_tutelageorcless
		add_political_power = 25
	}
	option = { #Nothing
		name = dorwinion.7.c
		add_political_power = 50
	}
}

country_event = {
	id = dorwinion.8
	title = dorwinion.8.t
	desc = dorwinion.8.d
	picture = GFX_report_event_paper

	is_triggered_only = yes


	option = { #Rhun Accepts Truce
		name = dorwinion.8.a
		ai_chance = {
			base = 40
			modifier = {
				add = 20
				ROOT = {
					has_opinion = {
					target = DOR
					value > 50
					}
				}
			}
			modifier = {
				add = 20
				DOR = {
					belligerent > 0.20
				}
			}
			modifier = {
				add = 20
				DOR = {
					has_government = belligerent
				}
			}
		}
		add_timed_idea = {
			idea = DOR_concessions_good
			days = 365
		}
		DOR = {
			if = {
				limit = {
					has_idea = DOR_concessions_bad
				}
				swap_ideas = {
					remove_idea = DOR_concessions_bad
					add_idea = DOR_concessions_bad_2
				}
			}
			else = {
				add_timed_idea = {
					idea = DOR_concessions_bad
					days = 365
				}
			}
		}
		
		set_truce = {
    		target = DOR
    		days = 365
		}
		DOR = {
			country_event = dorwinion.9
		}
	}
	option = { #Nothing
		name = dorwinion.8.b
		ai_chance = {
			base = 40
			modifier = {
				add = 20
				ROOT = {
					has_opinion = {
					target = DOR
					value < 50
					}
				}
			}
			modifier = {
				add = 20
				DOR = {
					belligerent < 0.20
				}
			}
			modifier = {
				add = 20
				DOR = {
					NOT = {
						has_government = belligerent
					}
					
				}
			}
		}
		DOR = {
			country_event = dorwinion.9
		}
		add_war_support = 0.1
		reverse_add_opinion_modifier = {
    		target = DOR
    		modifier = large_decrease
		}
	}
}

country_event = { #It was worth the try
	id = dorwinion.9
	title = dorwinion.9.t
	desc = dorwinion.9.d
	picture = GFX_report_event_paper

	is_triggered_only = yes


	option = { #Nothing
		name = dorwinion.9.a
		add_stability = -0.05
	}
}

country_event = { #We've only bought some time
	id = dorwinion.10
	title = dorwinion.10.t
	desc = dorwinion.10.d
	picture = GFX_report_event_paper

	is_triggered_only = yes


	option = { #Nothing
		name = dorwinion.10.a
		add_stability = 0.05
	}
}

country_event = { #Gondor event for Dor Rhunen joining their faction
	id = dorwinion.11
	title = dorwinion.11.t
	desc = dorwinion.11.d
	picture = GFX_report_event_paper

	is_triggered_only = yes


	option = { #We welcome Dor Rhunen
		name = dorwinion.11.a
		DOR = {
			dismantle_faction = yes
			add_stability = 0.10
		}
		GON = {
			add_to_faction = DOR
			add_stability = 0.10
		}
		ai_chance = {
			base = 60
		}
	}
	option = { #Nah they're insane
		name = dorwinion.11.b
		ai_chance = {
			base = 15
		}
		add_political_power = -100
		add_stability = -0.10
	}
}




country_event = {
	id = dorwinion.12
	title = dorwinion.12.t
	desc = dorwinion.12.desc
	picture = GFX_report_event_election_vote
	
	is_triggered_only = yes
	
	option = { #sure
		name = dorwinion.12.a
		ai_chance = {
			factor = 80

		}
		if = {
			limit = {
				AND = {
					NOT = { DOR = { has_completed_focus = DOR_assist_rhovanion } }
					NOT = { RHO = { has_opinion = { target = DOR value > 75 } } }
				}
			}
			random_list = {
				70 = { RHO = { country_event = { id = dorwinion.13 hours = 24 } } } #country votes yes
				30 = { RHO = { country_event = { id = dorwinion.14 hours = 24 } } } #country votes no
			}
		}
		if = {
			limit = {
				OR = {
					AND = {
						DOR = { has_completed_focus = DOR_assist_rhovanion } 
						NOT = { RHO = { has_opinion = { target = DOR value > 75 } } }
					}
					AND = {
						NOT = { DOR = { has_completed_focus = DOR_assist_rhovanion } }
						RHO = { has_opinion = { target = DOR value > 75 } } 
					}
				}
			}
			random_list = {
				80 = { RHO = { country_event = { id = dorwinion.13 hours = 24 } } } #country votes yes
				20 = { RHO = { country_event = { id = dorwinion.14 hours = 24 } } } #country votes no
			}
		}
		if = {
			limit = {
				AND = {
					DOR = { has_completed_focus = DOR_assist_rhovanion } 
					RHO = { has_opinion = { target = DOR value > 75 } } 
				}
			}
			random_list = {
				95 = { RHO = { country_event = { id = dorwinion.13 hours = 24 } } } #country votes yes
				5 = { RHO = { country_event = { id = dorwinion.14 hours = 24 } } } #country votes no
			}
		}
	}

	option = { #no
		name = dorwinion.12.b
		ai_chance = {
			factor = 20
			modifier = {
				has_government = cooperative
				factor = 0
			}
		}
		DOR = { country_event = { id = dorwinion.17 hours = 6 } }
	}

	option = { #sure, but we'll make sure it gets the right result
		name = dorwinion.1.c
		ai_chance = { factor = 160 }
		trigger = {
			OR = {
				has_government = revolutionary
				has_government = belligerent
			}
		}
		add_threat = -2
		add_political_power = -50
		RHO = { country_event = { id = dorwinion.18 hours = 24 } }
	}
}
#country votes yes
country_event = {
	id = dorwinion.13
	title = dorwinion.13.t
	desc = dorwinion.13.desc
	picture = GFX_report_event_election_vote
	
	is_triggered_only = yes

	option = {
		name = dorwinion.13.a
		custom_effect_tooltip = GAME_OVER_TT
		DOR = { country_event = { id = dorwinion.15 } }
		
	}

}

#country votes no
country_event = {
	id = dorwinion.14 
	title = dorwinion.14.t
	desc = dorwinion.14.desc
	picture = GFX_report_event_election_vote
	
	is_triggered_only = yes

	option = {
		name = dorwinion.14.a
		DOR = { country_event = { id = dorwinion.16 } }
	}

}

#country votes yes - hungary
country_event = {
	id = dorwinion.15 
	title = dorwinion.15.t
	desc = dorwinion.15.desc
	picture = GFX_report_event_election_vote
	
	is_triggered_only = yes

	option = {
		name = dorwinion.15.a
		RHO = {
			every_unit_leader = {
				set_nationality = DOR
			}
		}
		DOR = { annex_country = { target = RHO transfer_troops = yes } }
		DOR = { set_country_flag = RHO_annexed_peacefully } # Used to change division name lists for DOR
	}

}
#country votes no - hungary
country_event = {
	id = dorwinion.16 
	title = dorwinion.16.t
	desc = dorwinion.16.desc
	picture = GFX_report_event_election_vote
	
	is_triggered_only = yes

	option = { #TO WAR
		name = dorwinion.16.a
		ai_chance = {
			factor = 50
			modifier = {
				has_global_flag = DOR_referendum_shenanigans
				factor = 2
			}
		}
		create_wargoal = {
					type = annex_everything
					target = RHO
				}
		
	}
	option = { #Let it go
		name = dorwinion.16.b
		ai_chance = {
			factor = 50
			modifier = {
				RHO = { is_in_faction = yes }
				factor = 3
			}
		}
	}

}
#Austria refuses
country_event = {
	id = dorwinion.17
	title = dorwinion.17.t
	desc = dorwinion.17.desc
	picture = GFX_report_event_election_vote
	
	is_triggered_only = yes

	option = { #TO WAR
		name = dorwinion.17.a
		ai_chance = {
			factor = 30
			modifier = {
				RHO = {
					OR = {
						has_government = revolutionary
						has_government = belligerent
					}
				}
				factor = 3
			}
			modifier = {
				RHO = { is_in_faction = no }
				factor = 3
			}
			modifier = {
				strength_ratio = { tag = RHO ratio > 1 }
				factor = 2
			}
		}
		create_wargoal = {
					type = annex_everything
					target = RHO
				}
		
	}
	option = { #Let it go
		name = dorwinion.17.b
		ai_chance = {
			factor = 70
		}
	}

}
#Cheat on the Referendum
country_event = {
	id = dorwinion.18
	title = dorwinion.18.t
	desc = dorwinion.18.desc
	picture = GFX_report_event_election_vote
	
	is_triggered_only = yes

	option = { #say no
		name = dorwinion.18.a
		ai_chance = {
			factor = 80
		}
		DOR = { country_event = { id = dorwinion.16 } }
		
	}
	option = { #say yes
		name = dorwinion.18.b
		ai_chance = {
			factor = 20 #brilliant plan
		}
		custom_effect_tooltip = GAME_OVER_TT
		DOR = { country_event = { id = dorwinion.15 } }
	}

}